---
layout: single
title: "CMake"
categories: setup
tags: [Ubuntu, Compile]
toc: true
author_profile: false
sidebar:
    nav: "docs"
search: true
---
*CMake*


# ubuntu

```bash
sudo apt update
sudo apt install cmake
cmake --version
```

# window

- download GUI

## example, dcmtk

### dcmtk 준비
- dcmtk downloader [https://dicom.offis.de/en/dcmtk/dcmtk-software-development/](https://dicom.offis.de/en/dcmtk/dcmtk-software-development/)
    - DCMTK 3.6.8 Source Code and Documentation -> 다운로드 후 압축 풀고 이동 -> D:/Github_Blog/dcmtk-3.6.8
    - Pre-compiled libraries for Visual Studio 2022 (MSVC 17.4), 64 bit, with "MT" option -> 다운로드 후 압축 풀고 이동 -> D:\Github_Blog\dcmtk-3.6.8-win64-support-MT-msvc-17.4
    - prerequisit download (optional): bison [https://www.gnu.org/software/bison/](https://www.gnu.org/software/bison/)
        

### cmake 실행
- cmake.exe 실행
- where is the source code: D:/Github_Blog/dcmtk-3.6.8 빌드할 소스코드의 위치
- where to build the binaries: D:/Github_Blog/build 빌드 타겟 폴더, 새로 생성해서 만들기
- configure: 빌드 바이너리 생성 버튼 클릭
    - configuration 실패하면서 창이 빨간색으로 바뀔 것임
    - D:\Github_Blog\dcmtk-3.6.8-win64-support-MT-msvc-17.4
    - 다음 라이브러리의 사용을 체크한 후
        - DCMTK_WITH_ZLIB, DCMTK_WITH_XML, DCMTK_WITH_TIFF, DCMTK_WITH_THREADS, DCMTK_WITH_PNG, DCMTK_WITH_OPENSSL
    - cmake에 라이브러리와 헤더파일 경로(다운받은 것)를 알려줌
        - D:/Github_Blog/dcmtk-3.6.8-win64-support-MT-msvc-17.4/libpng-1.6.40
        - D:/Github_Blog/dcmtk-3.6.8-win64-support-MT-msvc-17.4/libtiff-4.6.0
        - D:/Github_Blog/dcmtk-3.6.8-win64-support-MT-msvc-17.4/libxml2-2.11.5
        - D:/Github_Blog/dcmtk-3.6.8-win64-support-MT-msvc-17.4/openjpeg-2.5.0
        - D:/Github_Blog/dcmtk-3.6.8-win64-support-MT-msvc-17.4/openssl-1.1.1w
        - D:/Github_Blog/dcmtk-3.6.8-win64-support-MT-msvc-17.4/zlib-1.3
- 다시 configure 버튼 클릭
    - 성공하면 창이 초록색
- Generate 버튼 클릭
    - 빌드 타겟 폴더에 솔루션(인스톨러) 생성


### visual studio
- visual studio > open solution > cmake에서 생성한 인스톨러의 솔루션을 연다
- build > batch build > install > release build 혹은 debug build 체크 > build 버튼 클릭 > 빌드 시작
- 하기 빌드 결과물 사용
    - D:\Github_Blog\build\lib (library)
    - D:\Github_Blog\build\include (header)
    - D:\Github_Blog\build\bin (dll)





 # CMakeLists.txt

- 역할: CMakeLists.txt 파일은 CMake 프로젝트의 루트 디렉토리에 위치한 텍스트 파일입니다. 이 파일은 CMake에게 프로젝트의 구성을 설명하고 빌드 과정을 정의하는 명령을 포함합니다.
- 내용: 일반적으로 CMakeLists.txt에는 빌드에 필요한 소스 파일, 헤더 파일, 라이브러리, 실행 파일 등의 정보가 포함됩니다. 또한 빌드 옵션, 디렉토리 구조, 의존성 등을 정의하는 명령어도 포함됩니다.

- 예시

```cmake
cmake_minimum_required(VERSION 3.10) # 최소 cmake 버전
project(cuda_project) // 프로젝트 이름

find_package(CUDA REQUIRED) // package 찾기
find_package(CUDAToolkit REQUIRED)

cuda_add_executable(myProgram main.cpp kernel.cu) // 실행파일 이름, 소스코드 (헤더 제외)
```



# CMake GUI

- 역할: CMake GUI는 그래픽 사용자 인터페이스를 제공하여 사용자가 CMake 프로젝트를 구성하고 생성할 수 있게 합니다. 이를 통해 사용자는 빌드 환경을 선택하고 빌드 옵션을 구성할 수 있습니다.
- 내용: CMake GUI는 텍스트 기반의 CMakeLists.txt를 편집하는 대신, 사용자가 그래픽 인터페이스를 통해 프로젝트를 구성할 수 있도록 합니다. 사용자는 폴더와 파일을 추가하고 빌드 옵션을 설정하여 빌드 프로세스를 커스터마이징할 수 있습니다.
- 사용 방법: 사용자는 CMake 프로젝트의 루트 디렉토리에서 CMake GUI를 실행하고, GUI를 통해 프로젝트의 구성 및 빌드 옵션을 설정한 후 빌드를 생성합니다.
- CMakeLists.txt에 대한 보완 정도이며, CMakeCache.txt에 보완 내용이 임시 저장되고 이를 통해 빌드할 수 있음.
    - CMakeLists.txt에 직접 저장해야 함